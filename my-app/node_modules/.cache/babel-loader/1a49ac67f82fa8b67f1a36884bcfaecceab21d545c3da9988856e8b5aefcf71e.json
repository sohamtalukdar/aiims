{"ast":null,"code":"import React,{useState,useRef,useEffect}from'react';import{useLocation,useNavigate}from'react-router-dom';// Add useNavigate here\nimport tasks from'./data/tasks';import'./App.css';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";function FileUploadForm(){const[isSubmitting,setIsSubmitting]=useState(false);const{state}=useLocation();const navigate=useNavigate();const[showModal,setShowModal]=useState(true);const[selectedTab,setSelectedTab]=useState(0);const[language,setLanguage]=useState('english');const[isRecording,setIsRecording]=useState(false);const[mediaURL,setMediaURL]=useState(\"\");const[showTick,setShowTick]=useState(false);const mediaRecorderRef=useRef(null);const mediaChunksRef=useRef([]);const[showImageModal,setShowImageModal]=useState(false);const[showInitialPopup,setShowInitialPopup]=useState(true);const[countdown,setCountdown]=useState(60);const[completedTasks,setCompletedTasks]=useState(new Set());const[currentQuestionIndex,setCurrentQuestionIndex]=useState(0);const[showInitialInstructions,setShowInitialInstructions]=useState(false);const[testCompleted,setTestCompleted]=useState(false);const[audioBlob,setAudioBlob]=useState(null);const[videoBlob,setVideoBlob]=useState(null);const[showRefreshWarning,setShowRefreshWarning]=useState(false);const[allSelectedAnswers,setAllSelectedAnswers]=useState(()=>{const savedData=sessionStorage.getItem(\"allSelectedAnswers\");return savedData?JSON.parse(savedData):{};});useEffect(()=>{if(!(state!==null&&state!==void 0&&state.patientId)||!(state!==null&&state!==void 0&&state.name)||!(state!==null&&state!==void 0&&state.age)){navigate('/');}},[state,navigate]);useEffect(()=>{sessionStorage.setItem(\"allSelectedAnswers\",JSON.stringify(allSelectedAnswers));},[allSelectedAnswers]);useEffect(()=>{const clearDataOnRefresh=()=>{sessionStorage.clear();};window.addEventListener(\"beforeunload\",clearDataOnRefresh);return()=>{window.removeEventListener(\"beforeunload\",clearDataOnRefresh);};},[]);useEffect(()=>{const blockRefresh=e=>{if(!showInitialPopup){// If test has started\ne.preventDefault();e.stopPropagation();// For older browsers\nif(e.preventDefault){e.preventDefault();}e.returnValue='';// Can also show a message if needed\nreturn\"Test is in progress. Refresh is disabled.\";}};const blockKeyboardRefresh=e=>{if(!showInitialPopup){// If test has started\nif(e.metaKey&&e.key==='r'||// Cmd + R (macOS)\ne.ctrlKey&&e.key==='r'||// Ctrl + R (Windows/Linux)\ne.key==='F5'// F5 (all platforms)\n){e.preventDefault();e.stopPropagation();return false;}}};// Block context menu to prevent refresh\nconst blockContextMenu=e=>{if(!showInitialPopup){e.preventDefault();}};// Add all event listeners\nwindow.addEventListener('beforeunload',blockRefresh);window.addEventListener('keydown',blockKeyboardRefresh);window.addEventListener('contextmenu',blockContextMenu);// Cleanup\nreturn()=>{window.removeEventListener('beforeunload',blockRefresh);window.removeEventListener('keydown',blockKeyboardRefresh);window.removeEventListener('contextmenu',blockContextMenu);};},[showInitialPopup]);const handleRefreshConfirm=()=>{setShowRefreshWarning(false);window.location.reload();// Perform manual refresh\n};const handleRefreshCancel=()=>{setShowRefreshWarning(false);};const TaskCompletion=_ref=>{let{language}=_ref;const audioRef=useRef(null);useEffect(()=>{if(audioRef.current){audioRef.current.play();}},[]);const calculateScore=()=>{let totalScore=0;console.log('Calculating score. allSelectedAnswers:',allSelectedAnswers);if(Object.keys(allSelectedAnswers).length===0){console.log('No answers selected, returning 0');return 0;}Object.entries(allSelectedAnswers).forEach(_ref2=>{let[questionIndex,selections]=_ref2;if(selections&&selections.length>0){console.log(`Question ${questionIndex}: adding ${selections.length} points`);totalScore+=selections.length;}});console.log('Final calculated score:',totalScore);return totalScore;};const score=calculateScore();const maxScore=30;const handleExit=()=>{sessionStorage.clear();window.location.href='/';};return/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col items-center justify-center min-h-screen p-8 bg-white max-w-2xl mx-auto\",children:[/*#__PURE__*/_jsx(\"audio\",{ref:audioRef,src:language==='english'?'/audio/q16_en.mp3':'/audio/q16_hi.mp3'}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-center w-full\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-3xl font-bold mb-8 text-gray-800\",children:language==='hindi'?'धन्यवाद!':'Thank You!'}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-blue-50 p-6 rounded-lg shadow-sm mb-8\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-semibold mb-2\",children:language==='hindi'?'आपका MMSE स्कोर':'Your MMSE Score'}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-4xl font-bold text-blue-600\",children:[score,\" / \",maxScore]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-lg\",children:language==='hindi'?'आपका परीक्षण पूरा हो गया है। परिणाम आपके स्वास्थ्य देखभाल प्रदाता द्वारा साझा किए जाएंगे।':'Your test has been completed. The results will be shared by your healthcare provider.'}),/*#__PURE__*/_jsx(\"p\",{className:\"text-base text-gray-600\",children:language==='hindi'?'कृपया अपने स्वास्थ्य देखभाल प्रदाता से संपर्क करें।':'Please contact your healthcare provider for follow-up.'}),/*#__PURE__*/_jsx(\"button\",{onClick:handleExit,style:{marginTop:'2rem',padding:'10px 20px',backgroundColor:'#007bff',color:'white',border:'none',borderRadius:'4px',cursor:'pointer',fontSize:'1rem',transition:'background-color 0.2s'},onMouseOver:e=>e.target.style.backgroundColor='#0056b3',onMouseOut:e=>e.target.style.backgroundColor='#007bff',children:language==='hindi'?'बाहर निकलें':'Exit'})]})]})]});};const handleTabClick=id=>{// Prevent navigation to completed tasks\nif(completedTasks.has(id)){return;}// Prevent going back to previous tasks\nconst currentTaskIndex=selectedTab;if(id<currentTaskIndex){return;}setCountdown(60);setMediaURL(\"\");mediaChunksRef.current=[];if(mediaRecorderRef.current&&mediaRecorderRef.current.state==='recording'){mediaRecorderRef.current.stop();mediaRecorderRef.current.stream.getTracks().forEach(track=>track.stop());}setSelectedTab(id);setShowModal(id!==2);if(id===2){setShowInitialInstructions(true);}else{setShowInitialInstructions(false);}};// const toggleLanguage = (e) => {\n//   e.preventDefault();\n//   setLanguage((prev) => (prev === 'hindi' ? 'english' : 'hindi'));\n// };\nconst handleMediaRecord=()=>{const mediaType=selectedTab===1?{video:true,audio:true}// Video with audio\n:{audio:true};// Audio only\nif(!isRecording){// Clear previous recording data when starting new recording\nsetMediaURL(\"\");setCountdown(60);// Reset the countdown\nif(selectedTab===1){setVideoBlob(null);}else{setAudioBlob(null);}console.log('Starting media recording for:',selectedTab===1?'video':'audio');navigator.mediaDevices.getUserMedia(mediaType).then(stream=>{const mediaRecorder=new MediaRecorder(stream);mediaRecorderRef.current=mediaRecorder;mediaChunksRef.current=[];mediaRecorder.start();setIsRecording(true);console.log('MediaRecorder started');const countdownInterval=setInterval(()=>{setCountdown(prev=>{if(prev<=1){clearInterval(countdownInterval);// Automatically stop recording when countdown reaches 0\nif(mediaRecorder.state===\"recording\"){console.log('Stopping recording due to countdown');mediaRecorder.stop();stream.getTracks().forEach(track=>track.stop());setIsRecording(false);}return 0;}return prev-1;});},1000);mediaRecorder.countdownInterval=countdownInterval;mediaRecorder.addEventListener('dataavailable',event=>{if(event.data.size>0){mediaChunksRef.current.push(event.data);console.log('Data chunk received:',event.data.size,'bytes');}});mediaRecorder.addEventListener('stop',()=>{const mediaBlob=new Blob(mediaChunksRef.current,{type:selectedTab===1?'video/webm':'audio/webm'});console.log('Created media blob:',{type:mediaBlob.type,size:mediaBlob.size});const url=URL.createObjectURL(mediaBlob);setMediaURL(url);if(selectedTab===1){setVideoBlob(mediaBlob);console.log('Video blob set:',mediaBlob);}else{setAudioBlob(mediaBlob);console.log('Audio blob set:',mediaBlob);}setIsRecording(false);mediaChunksRef.current=[];clearInterval(mediaRecorder.countdownInterval);});}).catch(err=>{console.error('Error accessing media:',err);setIsRecording(false);alert(`Could not access your ${selectedTab===1?'camera':'microphone'}. Please check your browser settings.`);});}else{if(mediaRecorderRef.current){mediaRecorderRef.current.stop();mediaRecorderRef.current.stream.getTracks().forEach(track=>track.stop());clearInterval(mediaRecorderRef.current.countdownInterval);setCountdown(0);console.log('Recording stopped manually');}}};const handleReRecord=()=>{// Clear the current recording\nsetMediaURL(\"\");if(selectedTab===1){setVideoBlob(null);}else{setAudioBlob(null);}// Clear media chunks\nmediaChunksRef.current=[];// Stop any existing streams\nif(mediaRecorderRef.current&&mediaRecorderRef.current.stream){mediaRecorderRef.current.stream.getTracks().forEach(track=>track.stop());}// Start new recording\nhandleMediaRecord();};// Inside the handleSubmit function in FileUploadForm.js, update it as follows:\nconst calculateScore=()=>{let totalScore=0;// Iterate through all questions\nObject.values(allSelectedAnswers).forEach(selections=>{// Each correct selection adds 1 point\nif(selections&&selections.length>0){totalScore+=selections.length;}});return totalScore;};const handleSubmit=async e=>{e.preventDefault();if(isSubmitting){console.log('Already submitting, returning');return;}console.log('Starting submission for tab:',selectedTab);setIsSubmitting(true);try{if(!(state!==null&&state!==void 0&&state.patientId)||!(state!==null&&state!==void 0&&state.name)||!(state!==null&&state!==void 0&&state.age)){alert('Patient information is missing. Please start over.');navigate('/');return;}const formData=new FormData();formData.append('name',state.name);formData.append('age',state.age);formData.append('patientId',state.patientId);// Initialize score as 0\nlet scoreToSend='0';// Only calculate score for MMSE test (tab 2)\nif(selectedTab===2){const calculatedScore=calculateScore();console.log('Tab 2: Calculated score:',calculatedScore);scoreToSend=calculatedScore.toString();}else{console.log(`Tab ${selectedTab}: Using default score: 0`);}console.log('Setting score in formData:',scoreToSend);formData.append('score',scoreToSend);// Log all form data being sent\nconsole.log('Form data contents:');for(let pair of formData.entries()){console.log(`${pair[0]}: ${pair[1]}`);}const currentBlob=selectedTab===1?videoBlob:audioBlob;if(!currentBlob){alert(`Please record ${selectedTab===1?'video':'audio'} before submitting.`);setIsSubmitting(false);return;}if(selectedTab===1){formData.append('video',currentBlob,'video.webm');}else if(selectedTab===0){formData.append('audio',currentBlob,'audio.webm');}console.log('Sending request to server...');const response=await fetch('http://localhost:5001/save',{method:'POST',body:formData});if(!response.ok){const errorData=await response.json();throw new Error(errorData.error||'Upload failed');}const result=await response.json();console.log('Server response:',result);setShowTick(true);setTimeout(()=>{setShowTick(false);setCompletedTasks(prev=>new Set([...prev,selectedTab]));const nextTab=selectedTab+1;if(nextTab<tasks.length){handleTabClick(nextTab);}},1000);setMediaURL('');if(selectedTab===1){setVideoBlob(null);}else{setAudioBlob(null);}}catch(error){console.error('Submission error:',error);alert(error.message||'Error uploading file. Please try again.');}finally{setIsSubmitting(false);}};const InstructionModal=_ref3=>{let{onClose}=_ref3;const audioRef=useRef(null);useEffect(()=>{if(audioRef.current){audioRef.current.play();}},[]);// Removed language from dependency array\nreturn/*#__PURE__*/_jsx(\"div\",{className:\"custom-modal-overlay\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"custom-modal-content\",children:[/*#__PURE__*/_jsx(\"audio\",{ref:audioRef,src:selectedTab===0?language==='english'?'/audio/q2_en.mp3':'/audio/q2_hi.mp3':language==='english'?'/audio/q3_en.mp3':'/audio/q3_hi.mp3'}),/*#__PURE__*/_jsx(\"h2\",{children:language==='hindi'?'निर्देश':'Instructions'}),/*#__PURE__*/_jsx(\"p\",{style:{marginTop:'10px',fontSize:'1.2em',color:'#555'},children:selectedTab===0?language==='hindi'?/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(\"p\",{children:\"\\u0915\\u0943\\u092A\\u092F\\u093E \\\"\\u0906\\u0935\\u093E\\u091C\\u093C \\u0930\\u093F\\u0915\\u0949\\u0930\\u094D\\u0921 \\u0915\\u0930\\u0947\\u0902\\\" \\u092A\\u0930 \\u0915\\u094D\\u0932\\u093F\\u0915 \\u0915\\u0930\\u0947\\u0902 \\u0914\\u0930 \\u091C\\u094B\\u0930 \\u0938\\u0947 \\u092A\\u0922\\u093C\\u0947\\u0902\\u0964 \\u0906\\u092A\\u0915\\u0947 \\u092A\\u093E\\u0938 1 \\u092E\\u093F\\u0928\\u091F \\u0939\\u0948\\u0964 \\u0930\\u093F\\u0915\\u0949\\u0930\\u094D\\u0921\\u093F\\u0902\\u0917 \\u0938\\u094D\\u0935\\u091A\\u093E\\u0932\\u093F\\u0924 \\u0930\\u0942\\u092A \\u0938\\u0947 \\u0930\\u0941\\u0915 \\u091C\\u093E\\u090F\\u0917\\u0940\\u0964 \\\"\\u091C\\u092E\\u093E \\u0915\\u0930\\u0947\\u0902\\\" \\u092A\\u0930 \\u0915\\u094D\\u0932\\u093F\\u0915 \\u0915\\u0930\\u0947\\u0902\\u0964\"})}):/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(\"p\",{children:\"Please click \\\"Record Voice\\\" to start reading aloud. You have 1 minute. Recording will stop automatically. Click \\\"Submit\\\" to save.\"})}):language==='hindi'?/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(\"p\",{children:\"\\u0915\\u0943\\u092A\\u092F\\u093E \\\"\\u0935\\u0940\\u0921\\u093F\\u092F\\u094B \\u0930\\u093F\\u0915\\u0949\\u0930\\u094D\\u0921 \\u0915\\u0930\\u0947\\u0902\\\" \\u092A\\u0930 \\u0915\\u094D\\u0932\\u093F\\u0915 \\u0915\\u0930\\u0947\\u0902 \\u0914\\u0930 \\u091A\\u093F\\u0924\\u094D\\u0930 \\u0915\\u093E \\u0935\\u0930\\u094D\\u0923\\u0928 \\u0915\\u0930\\u0947\\u0902\\u0964 \\u0906\\u092A\\u0915\\u0947 \\u092A\\u093E\\u0938 1 \\u092E\\u093F\\u0928\\u091F \\u0939\\u0948\\u0964 \\u0930\\u093F\\u0915\\u0949\\u0930\\u094D\\u0921\\u093F\\u0902\\u0917 \\u0938\\u094D\\u0935\\u091A\\u093E\\u0932\\u093F\\u0924 \\u0930\\u0942\\u092A \\u0938\\u0947 \\u0930\\u0941\\u0915 \\u091C\\u093E\\u090F\\u0917\\u0940\\u0964 \\\"\\u091C\\u092E\\u093E \\u0915\\u0930\\u0947\\u0902\\\" \\u092A\\u0930 \\u0915\\u094D\\u0932\\u093F\\u0915 \\u0915\\u0930\\u0947\\u0902\\u0964 \\u091C\\u093C\\u0942\\u092E \\u0907\\u0928 \\u0915\\u0947 \\u0932\\u093F\\u090F, \\u0915\\u0943\\u092A\\u092F\\u093E \\u091A\\u093F\\u0924\\u094D\\u0930 \\u092A\\u0930 \\u0915\\u094D\\u0932\\u093F\\u0915 \\u0915\\u0930\\u0947\\u0902\\u0964\"})}):/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(\"p\",{children:\"Please click \\\"Record Video\\\" and describe the picture. You have 1 minute. Recording will stop automatically. Click \\\"Submit\\\" to save. To zoom in, please click on the picture.\"})})}),/*#__PURE__*/_jsx(\"button\",{className:\"custom-ok-button\",onClick:onClose,children:\"OK\"})]})});};const InitialInstructions=_ref4=>{let{onAccept,onDeny,setIsPatient,language}=_ref4;const audioRef=useRef(null);useEffect(()=>{if(audioRef.current){audioRef.current.play();}},[]);return/*#__PURE__*/_jsx(\"div\",{className:\"initial-instructions-overlay\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"initial-instructions-content\",children:[/*#__PURE__*/_jsx(\"audio\",{ref:audioRef,src:language==='english'?'/audio/q4_en.mp3':'/audio/q4_hi.mp3'}),/*#__PURE__*/_jsx(\"h2\",{children:language==='hindi'?'ऑनलाइन MMSE परीक्षण में आपका स्वागत है':'Welcome to the Online MMSE Test'}),/*#__PURE__*/_jsx(\"p\",{children:language==='hindi'?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u0911\\u0928\\u0932\\u093E\\u0907\\u0928 MMSE \\u091F\\u0947\\u0938\\u094D\\u091F: \\u0924\\u0948\\u092F\\u093E\\u0930\\u0940 \\u0914\\u0930 \\u0928\\u093F\\u0930\\u094D\\u0926\\u0947\\u0936\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{}),\"\\u0938\\u094D\\u0935\\u093E\\u0917\\u0924 \\u0939\\u0948! \\u091F\\u0947\\u0938\\u094D\\u091F \\u0936\\u0941\\u0930\\u0942 \\u0915\\u0930\\u0928\\u0947 \\u0938\\u0947 \\u092A\\u0939\\u0932\\u0947 \\u0915\\u0943\\u092A\\u092F\\u093E \\u0928\\u093F\\u092E\\u094D\\u0928\\u0932\\u093F\\u0916\\u093F\\u0924 \\u0938\\u0941\\u0928\\u093F\\u0936\\u094D\\u091A\\u093F\\u0924 \\u0915\\u0930\\u0947\\u0902:\",/*#__PURE__*/_jsxs(\"ul\",{children:[/*#__PURE__*/_jsx(\"li\",{children:\"\\u090F\\u0915 \\u0926\\u0947\\u0916\\u092D\\u093E\\u0932\\u0915\\u0930\\u094D\\u0924\\u093E (Caregiver) \\u0915\\u0940 \\u0909\\u092A\\u0938\\u094D\\u0925\\u093F\\u0924\\u093F \\u0906\\u0935\\u0936\\u094D\\u092F\\u0915 \\u0939\\u0948, \\u091C\\u094B \\u091F\\u0947\\u0938\\u094D\\u091F \\u0932\\u0947 \\u0938\\u0915\\u0947\\u0964\"}),/*#__PURE__*/_jsx(\"li\",{children:\"\\u090F\\u0915 \\u0916\\u093E\\u0932\\u0940 \\u0915\\u093E\\u0917\\u091C\"}),/*#__PURE__*/_jsx(\"li\",{children:\"\\u090F\\u0915 \\u092A\\u0947\\u0928 \\u092F\\u093E \\u092A\\u0947\\u0902\\u0938\\u093F\\u0932\"}),/*#__PURE__*/_jsx(\"li\",{children:\"\\u0906\\u0935\\u0936\\u094D\\u092F\\u0915 \\u0938\\u0939\\u093E\\u092F\\u0915 \\u0909\\u092A\\u0915\\u0930\\u0923 (\\u091C\\u0948\\u0938\\u0947, \\u0936\\u094D\\u0930\\u0935\\u0923 \\u092F\\u0902\\u0924\\u094D\\u0930, \\u091A\\u0936\\u094D\\u092E\\u093E, \\u0918\\u0921\\u093C\\u0940)\"})]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"strong\",{children:\"\\u0926\\u0947\\u0916\\u092D\\u093E\\u0932\\u0915\\u0930\\u094D\\u0924\\u093E \\u0915\\u0947 \\u0932\\u093F\\u090F \\u0928\\u093F\\u0930\\u094D\\u0926\\u0947\\u0936:\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"ul\",{children:[/*#__PURE__*/_jsx(\"li\",{children:\"\\u0935\\u094D\\u092F\\u0915\\u094D\\u0924\\u093F \\u0915\\u094B \\u092C\\u0948\\u0920\\u093E\\u090F\\u0901: \\u0935\\u094D\\u092F\\u0915\\u094D\\u0924\\u093F \\u0915\\u094B \\u0905\\u092A\\u0928\\u0947 \\u0938\\u093E\\u092E\\u0928\\u0947 \\u0910\\u0938\\u0940 \\u091C\\u0917\\u0939 \\u092A\\u0930 \\u092C\\u0948\\u0920\\u093E\\u090F\\u0901 \\u091C\\u0939\\u093E\\u0901 \\u0935\\u0947 \\u0906\\u092A\\u0915\\u094B \\u0938\\u094D\\u092A\\u0937\\u094D\\u091F \\u0930\\u0942\\u092A \\u0938\\u0947 \\u0926\\u0947\\u0916 \\u0914\\u0930 \\u0938\\u0941\\u0928 \\u0938\\u0915\\u0947\\u0902\\u0964\"}),/*#__PURE__*/_jsx(\"li\",{children:\"\\u092A\\u094D\\u0930\\u0936\\u094D\\u0928 \\u092A\\u0922\\u093C\\u0947\\u0902: \\u092A\\u094D\\u0930\\u0924\\u094D\\u092F\\u0947\\u0915 \\u092A\\u094D\\u0930\\u0936\\u094D\\u0928 \\u0915\\u094B \\u0935\\u094D\\u092F\\u0915\\u094D\\u0924\\u093F \\u0915\\u0947 \\u0932\\u093F\\u090F \\u091C\\u093C\\u094B\\u0930 \\u0938\\u0947 \\u092A\\u0922\\u093C\\u0947\\u0902\\u0964\"}),/*#__PURE__*/_jsx(\"li\",{children:\"\\u0909\\u0924\\u094D\\u0924\\u0930 \\u091A\\u093F\\u0939\\u094D\\u0928\\u093F\\u0924 \\u0915\\u0930\\u0947\\u0902: \\u092F\\u0926\\u093F \\u0935\\u094D\\u092F\\u0915\\u094D\\u0924\\u093F \\u0938\\u0939\\u0940 \\u0909\\u0924\\u094D\\u0924\\u0930 \\u0926\\u0947\\u0924\\u093E \\u0939\\u0948 \\u0924\\u094B \\u091A\\u0947\\u0915\\u092C\\u0949\\u0915\\u094D\\u0938 \\u092A\\u0930 \\u0928\\u093F\\u0936\\u093E\\u0928 \\u0932\\u0917\\u093E\\u090F\\u0901\\u0964\"}),/*#__PURE__*/_jsx(\"li\",{children:\"\\u0905\\u0917\\u0932\\u0947 \\u092A\\u0930 \\u091C\\u093E\\u090F\\u0902: \\u0939\\u0930 \\u092A\\u094D\\u0930\\u0936\\u094D\\u0928 \\u0915\\u0947 \\u092C\\u093E\\u0926 \\\"\\u0905\\u0917\\u0932\\u093E\\\" \\u092A\\u0930 \\u0915\\u094D\\u0932\\u093F\\u0915 \\u0915\\u0930\\u0947\\u0902\\u0964\"})]}),/*#__PURE__*/_jsx(\"br\",{}),\"\\u0915\\u094D\\u092F\\u093E \\u0906\\u092A \\u0936\\u0941\\u0930\\u0942 \\u0915\\u0930\\u0928\\u0947 \\u0915\\u0947 \\u0932\\u093F\\u090F \\u0924\\u0948\\u092F\\u093E\\u0930 \\u0939\\u0948\\u0902?\"]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Online MMSE Test: Preparation & Instructions\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{}),\"Welcome! Before starting the test, please ensure the following:\",/*#__PURE__*/_jsxs(\"ul\",{children:[/*#__PURE__*/_jsx(\"li\",{children:\"A caregiver is present to administer the test.\"}),/*#__PURE__*/_jsx(\"li\",{children:\"A blank paper\"}),/*#__PURE__*/_jsx(\"li\",{children:\"A pen or pencil\"}),/*#__PURE__*/_jsx(\"li\",{children:\"Any necessary aids (e.g., hearing aids, glasses, clock)\"})]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"strong\",{children:\"Instructions for the Caregiver:\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"ul\",{children:[/*#__PURE__*/_jsx(\"li\",{children:\"Seat the Patient: Position the patient across from you, where they can see and hear you clearly.\"}),/*#__PURE__*/_jsx(\"li\",{children:\"Read Aloud: Read each question out loud to the patient.\"}),/*#__PURE__*/_jsx(\"li\",{children:\"Mark Responses: Check the box if the patient answers correctly.\"}),/*#__PURE__*/_jsx(\"li\",{children:\"Progress: Click \\\"Next\\\" after each question.\"})]}),/*#__PURE__*/_jsx(\"br\",{}),\"Are you ready to begin?\"]})}),/*#__PURE__*/_jsx(\"p\",{children:language==='hindi'?'यदि आप \"स्वीकार करें\" पर क्लिक करते हैं, तो आप परीक्षण में भाग लेने के लिए सहमत हैं।':'By clicking \"Accept,\" you agree to participate in the test.'}),/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:'20px'},children:[/*#__PURE__*/_jsx(\"button\",{className:\"accept-button\",onClick:onAccept,children:language==='hindi'?'स्वीकार करें':'Accept'}),/*#__PURE__*/_jsx(\"button\",{className:\"deny-button\",onClick:onDeny,style:{marginLeft:'10px'},children:language==='hindi'?'अस्वीकार करें':'Deny'})]})]})});};const MultipleChoiceTask=_ref5=>{let{task,language,setTestCompleted,currentQuestionIndex,setCurrentQuestionIndex,allSelectedAnswers,setAllSelectedAnswers}=_ref5;const{state}=useLocation();const handleNext=()=>{if(currentQuestionIndex<task.questions.length-1){setCurrentQuestionIndex(currentQuestionIndex+1);}};const handlePrevious=()=>{if(currentQuestionIndex>0){setCurrentQuestionIndex(currentQuestionIndex-1);}};const handleAnswerSelect=choiceIndex=>{setAllSelectedAnswers(prevSelected=>{const updatedAnswers={...prevSelected};// Initialize array for current question if it doesn't exist\nif(!updatedAnswers[currentQuestionIndex]){updatedAnswers[currentQuestionIndex]=[];}const currentAnswers=updatedAnswers[currentQuestionIndex];// Toggle selection\nconst index=currentAnswers.indexOf(choiceIndex);if(index===-1){// Add the choice if not already selected\nupdatedAnswers[currentQuestionIndex]=[...currentAnswers,choiceIndex];}else{// Remove the choice if already selected\nupdatedAnswers[currentQuestionIndex]=currentAnswers.filter(idx=>idx!==choiceIndex);}return updatedAnswers;});};const totalSelectedCount=Object.values(allSelectedAnswers).reduce((total,selections)=>total+selections.length,0);const currentSelections=allSelectedAnswers[currentQuestionIndex]||[];return/*#__PURE__*/_jsxs(\"div\",{className:\"multiple-choice-task\",children:[/*#__PURE__*/_jsx(\"h3\",{style:{textAlign:'center',marginBottom:'5px'},children:task.questions[currentQuestionIndex].question[language]}),currentQuestionIndex===10?/*#__PURE__*/_jsxs(\"div\",{style:{textAlign:'center',marginTop:'10px'},children:[/*#__PURE__*/_jsx(\"img\",{src:process.env.PUBLIC_URL+'/pentagon.png',alt:\"Shape for copying\",style:{maxWidth:'45%',height:'auto'},onError:e=>{console.error(\"Image failed to load\");console.log(\"Attempted path:\",e.target.src);}}),/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',flexDirection:'column',alignItems:'center',marginTop:'10px'},children:task.questions[currentQuestionIndex].choices.map((choice,index)=>/*#__PURE__*/_jsxs(\"label\",{style:{display:'flex',alignItems:'center',textAlign:'center',margin:'5px 0',width:'200px'},children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:currentSelections.includes(index),onChange:()=>handleAnswerSelect(index),style:{marginRight:'10px'}}),choice[language]]},index))})]}):/*#__PURE__*/// Default rendering for other questions\n_jsx(\"div\",{style:{display:'flex',flexDirection:'column',alignItems:'center',justifyContent:'center',minHeight:'30vh',marginTop:'10px'},children:task.questions[currentQuestionIndex].choices.map((choice,index)=>/*#__PURE__*/_jsxs(\"label\",{style:{display:'flex',alignItems:'center',textAlign:'center',margin:'5px 0',width:'200px'},children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:currentSelections.includes(index),onChange:()=>handleAnswerSelect(index),style:{marginRight:'10px'}}),choice[language]]},index))}),/*#__PURE__*/_jsxs(\"div\",{className:\"navigation-container\",style:{display:'flex',justifyContent:'space-between',alignItems:'center',marginTop:'10px'},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"navigation-buttons\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:handlePrevious,disabled:currentQuestionIndex===0,style:{marginRight:'10px'},children:language==='hindi'?'पिछला':'Previous'}),/*#__PURE__*/_jsx(\"button\",{onClick:handleNext,disabled:currentQuestionIndex===task.questions.length-1,children:language==='hindi'?'अगला':'Next'})]}),/*#__PURE__*/_jsx(\"div\",{className:\"selected-counter\",style:{marginRight:'20px'},children:language==='hindi'?`चयनित: ${totalSelectedCount}`:`Score: ${totalSelectedCount}`})]}),/*#__PURE__*/_jsx(\"div\",{className:\"question-number-navigation\",style:{marginTop:'10px',display:'flex',justifyContent:'center',flexWrap:'wrap'},children:task.questions.map((q,index)=>/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setCurrentQuestionIndex(index);},style:{margin:'5px',padding:'10px',backgroundColor:index===currentQuestionIndex?'#007bff':'#f0f0f0',color:index===currentQuestionIndex?'#fff':'#000',border:'1px solid #ccc',borderRadius:'4px',cursor:'pointer'},children:index+1},index))}),/*#__PURE__*/_jsx(\"div\",{style:{marginTop:'20px',textAlign:'center'},children:/*#__PURE__*/_jsx(\"button\",{onClick:async()=>{const finalScore=Object.values(allSelectedAnswers).reduce((total,selections)=>total+(selections?selections.length:0),0);console.log('Final MMSE score:',finalScore);const formData=new FormData();formData.append('name',state.name);formData.append('age',state.age);formData.append('patientId',state.patientId);formData.append('score',finalScore.toString());try{console.log('Sending MMSE score to server:',finalScore);const response=await fetch('http://localhost:5001/save',{method:'POST',body:formData});if(!response.ok){throw new Error('Failed to save MMSE score');}console.log('MMSE score saved successfully');setTestCompleted(true);}catch(error){console.error('Error saving MMSE score:',error);alert('Failed to save test score. Please try again.');}},style:{padding:'10px 20px',backgroundColor:'#28a745',color:'#fff',border:'none',borderRadius:'4px',cursor:'pointer'},children:language==='hindi'?'जमा करें':'Submit'})})]});};const TaskContent=_ref6=>{let{task,language,testCompleted,showInitialInstructions,setShowInitialInstructions,setTestCompleted,allSelectedAnswers,setAllSelectedAnswers,setIsPatient,currentQuestionIndex,setCurrentQuestionIndex}=_ref6;if(task.id===2){if(testCompleted){return/*#__PURE__*/_jsx(\"div\",{className:\"w-full flex justify-center items-center\",children:/*#__PURE__*/_jsx(TaskCompletion,{language:language,allSelectedAnswers:allSelectedAnswers})});}// If initial instructions are to be shown\nif(showInitialInstructions){return/*#__PURE__*/_jsx(InitialInstructions,{onAccept:()=>setShowInitialInstructions(false),onDeny:()=>{setShowInitialInstructions(false);setTestCompleted(true);},setIsPatient:setIsPatient// Pass it here\n,language:language});}// Render the MultipleChoiceTask\nreturn/*#__PURE__*/_jsx(MultipleChoiceTask,{task:task,language:language,setTestCompleted:setTestCompleted,allSelectedAnswers:allSelectedAnswers,setAllSelectedAnswers:setAllSelectedAnswers,currentQuestionIndex:currentQuestionIndex,setCurrentQuestionIndex:setCurrentQuestionIndex});}return/*#__PURE__*/_jsx(\"div\",{className:\"task-content\",children:task.image?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{style:{textAlign:'left',marginBottom:'5px',fontSize:'14px',color:'#666',cursor:'pointer'},children:[language==='hindi'?'ज़ूम इन/ज़ूम आउट करने के लिए छवि पर क्लिक करें':'Click on the image to zoom in / zoom out',\" \\uD83D\\uDD0D\"]}),/*#__PURE__*/_jsx(\"img\",{src:task.image,alt:\"Task\",style:{cursor:'pointer',maxWidth:'100%',maxHeight:'100%'},onClick:()=>setShowImageModal(true)}),showImageModal&&/*#__PURE__*/_jsx(\"div\",{className:\"image-modal\",children:/*#__PURE__*/_jsx(\"img\",{src:task.image,alt:\"Popup Task\",style:{maxWidth:'90%',maxHeight:'90%',objectFit:'contain'},onClick:()=>setShowImageModal(false)})})]}):/*#__PURE__*/_jsx(\"p\",{style:{width:'60%',margin:'0 auto',lineHeight:'1.8',fontSize:'1.1em'},children:task.paragraph[language]})});};const InitialPopup=_ref7=>{let{language,setLanguage,onClose}=_ref7;const audioRef=useRef(null);useEffect(()=>{if(audioRef.current){audioRef.current.play();}},[language]);return/*#__PURE__*/_jsxs(\"div\",{className:\"initial-popup-overlay\",style:{position:'fixed',top:0,left:0,width:'100%',height:'100%',backgroundColor:'white',zIndex:1000,display:'flex',justifyContent:'center',alignItems:'center'},children:[/*#__PURE__*/_jsx(\"audio\",{ref:audioRef,src:language==='english'?'/audio/q1_en.mp3':'/audio/q1_hi.mp3'}),/*#__PURE__*/_jsxs(\"div\",{className:\"initial-popup-content\",style:{maxWidth:'600px',width:'90%',textAlign:'center'},children:[/*#__PURE__*/_jsx(\"h2\",{children:language==='english'?'Welcome to the Dementia Test!':'डिमेंशिया टेस्ट में आपका स्वागत है!'}),/*#__PURE__*/_jsx(\"p\",{style:{marginTop:'10px',fontSize:'1.2em',color:'#555'},children:language==='english'?/*#__PURE__*/_jsxs(_Fragment,{children:[\"This test includes three parts:\",/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"strong\",{children:\"Paragraph Reading\"}),\" (1 min)\",/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"strong\",{children:\"Picture Interpretation\"}),\" (1 min)\",/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"strong\",{children:\"MMSE online test\"}),\" (~15 min, requires a caregiver if available)\",/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{}),\"Please ensure you're in a quiet space with audio and video recording permissions enabled.\",/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{}),\"Please Choose the language for the test\"]}):/*#__PURE__*/_jsxs(_Fragment,{children:[\"\\u092F\\u0939 \\u091F\\u0947\\u0938\\u094D\\u091F \\u0924\\u0940\\u0928 \\u092D\\u093E\\u0917\\u094B\\u0902 \\u092E\\u0947\\u0902 \\u0939\\u0948:\",/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"strong\",{children:\"\\u092A\\u0948\\u0930\\u093E\\u0917\\u094D\\u0930\\u093E\\u092B \\u092A\\u0922\\u093C\\u0928\\u093E\"}),\" (1 \\u092E\\u093F\\u0928\\u091F)\",/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"strong\",{children:\"\\u091A\\u093F\\u0924\\u094D\\u0930 \\u0935\\u094D\\u092F\\u093E\\u0916\\u094D\\u092F\\u093E\"}),\" (1 \\u092E\\u093F\\u0928\\u091F)\",/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"strong\",{children:\"MMSE \\u0911\\u0928\\u0932\\u093E\\u0907\\u0928 \\u091F\\u0947\\u0938\\u094D\\u091F\"}),\" (~15 \\u092E\\u093F\\u0928\\u091F, \\u0915\\u0947\\u092F\\u0930\\u0917\\u093F\\u0935\\u0930 \\u0909\\u092A\\u0932\\u092C\\u094D\\u0927 \\u0939\\u094B \\u0924\\u094B)\",/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{}),\"\\u0915\\u0943\\u092A\\u092F\\u093E \\u0938\\u0941\\u0928\\u093F\\u0936\\u094D\\u091A\\u093F\\u0924 \\u0915\\u0930\\u0947\\u0902 \\u0915\\u093F \\u0906\\u092A \\u0936\\u093E\\u0902\\u0924 \\u0938\\u094D\\u0925\\u093E\\u0928 \\u092E\\u0947\\u0902 \\u0939\\u0948\\u0902 \\u0914\\u0930 \\u0911\\u0921\\u093F\\u092F\\u094B-\\u0935\\u0940\\u0921\\u093F\\u092F\\u094B \\u0930\\u093F\\u0915\\u0949\\u0930\\u094D\\u0921\\u093F\\u0902\\u0917 \\u0905\\u0928\\u0941\\u092E\\u0924\\u093F \\u0938\\u0915\\u094D\\u0937\\u092E \\u0939\\u0948\\u0964\",/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{}),\"\\u0915\\u0943\\u092A\\u092F\\u093E \\u092A\\u0930\\u0940\\u0915\\u094D\\u0937\\u0923 \\u0915\\u0947 \\u0932\\u093F\\u090F \\u092D\\u093E\\u0937\\u093E \\u091A\\u0941\\u0928\\u0947\\u0902\"]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"language-selection\",style:{marginTop:'20px'},children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setLanguage('english'),className:`language-button ${language==='english'?'active':''}`,style:{marginRight:'10px',padding:'10px 20px'},children:\"English\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setLanguage('hindi'),className:`language-button ${language==='hindi'?'active':''}`,style:{padding:'10px 20px'},children:\"\\u0939\\u093F\\u0902\\u0926\\u0940\"})]}),/*#__PURE__*/_jsx(\"button\",{onClick:onClose,className:\"begin-test-button\",style:{marginTop:'20px',padding:'10px 20px'},children:language==='english'?'Begin Test':'टेस्ट शुरू करें'})]})]});};return/*#__PURE__*/_jsxs(\"div\",{className:\"app\",children:[(state===null||state===void 0?void 0:state.patientId)&&/*#__PURE__*/_jsxs(\"div\",{style:{position:'fixed',top:'20px',right:'20px',backgroundColor:'white',padding:'8px 12px',borderRadius:'4px',boxShadow:'0 2px 4px rgba(0, 0, 0, 0.1)',zIndex:1000,fontFamily:'monospace',fontSize:'14px',border:'1px solid #ddd'},children:[\"Patient ID: \",state.patientId]}),showInitialPopup?/*#__PURE__*/_jsx(InitialPopup,{language:language,setLanguage:setLanguage,onClose:()=>setShowInitialPopup(false)}):/*#__PURE__*/_jsxs(_Fragment,{children:[showModal&&/*#__PURE__*/_jsx(InstructionModal,{onClose:()=>setShowModal(false)}),/*#__PURE__*/_jsx(\"div\",{className:\"gradient-bg\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"tabs\",children:tasks.filter(task=>!(task.id===2&&testCompleted)).map(task=>/*#__PURE__*/_jsxs(\"div\",{className:`tab ${selectedTab===task.id?'active':''} \n                              ${completedTasks.has(task.id)?'completed':''}\n                              ${task.id<selectedTab?'disabled':''}`,onClick:()=>handleTabClick(task.id),style:{cursor:completedTasks.has(task.id)||task.id<selectedTab?'not-allowed':'pointer',opacity:completedTasks.has(task.id)||task.id<selectedTab?0.6:1,backgroundColor:completedTasks.has(task.id)?'#e0e0e0':undefined},children:[task.title[language],completedTasks.has(task.id)&&/*#__PURE__*/_jsx(\"span\",{style:{marginLeft:'5px',color:'green'},children:\"\\u2713\"})]},task.id))}),/*#__PURE__*/_jsxs(\"div\",{className:\"content\",children:[/*#__PURE__*/_jsx(TaskContent,{task:tasks[selectedTab],language:language,testCompleted:testCompleted,showInitialInstructions:showInitialInstructions,setShowInitialInstructions:setShowInitialInstructions,setTestCompleted:setTestCompleted,allSelectedAnswers:allSelectedAnswers,setAllSelectedAnswers:setAllSelectedAnswers,currentQuestionIndex:currentQuestionIndex,setCurrentQuestionIndex:setCurrentQuestionIndex}),selectedTab!==2&&/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"media-form\",style:{display:'flex',flexDirection:'column',alignItems:'center',gap:'15px',marginTop:'20px'},children:[/*#__PURE__*/_jsx(\"div\",{className:\"media-controls\",children:mediaURL?/*#__PURE__*/_jsxs(\"div\",{className:\"media-playback\",children:[selectedTab===1?/*#__PURE__*/_jsx(\"video\",{src:mediaURL,controls:true,style:{maxWidth:'350px',// Set maximum width\nwidth:'100%',// Responsive width\nheight:'auto',// Maintain aspect ratio\nmarginBottom:'10px'// Add some spacing\n}}):/*#__PURE__*/_jsx(\"audio\",{src:mediaURL,controls:true}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:handleReRecord,className:\"custom-button\",children:language==='hindi'?'पुनः रिकॉर्ड करें':'Re-record'})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"recording-controls\",children:[/*#__PURE__*/_jsx(\"div\",{style:{textAlign:'center',marginTop:'10px'},children:isRecording&&/*#__PURE__*/_jsxs(\"p\",{children:[\"Time remaining: \",countdown,\"s\"]})}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:handleMediaRecord,className:\"custom-button\",style:{marginBottom:'10px',padding:'8px 12px',backgroundColor:'#007bff',color:'white',border:'none',borderRadius:'4px',cursor:'pointer'},children:isRecording?language==='hindi'?'रिकॉर्डिंग रोकें':'Stop Recording':language==='hindi'?selectedTab===1?'वीडियो रिकॉर्ड करें':'आवाज़ रिकॉर्ड करें':selectedTab===1?'Record Video':'Record Voice'})]})}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:!mediaURL||isSubmitting,className:\"custom-button\",style:{opacity:!mediaURL||isSubmitting?0.6:1},children:language==='hindi'?'जमा करें':'Submit'}),showTick&&/*#__PURE__*/_jsx(\"span\",{className:\"tick\",children:\"\\u2714\"})]})]})]}),showRefreshWarning&&/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal-content\",children:[/*#__PURE__*/_jsx(\"h2\",{children:language==='hindi'?'पृष्ठ रीफ्रेश की पुष्टि करें':'Confirm Page Refresh'}),/*#__PURE__*/_jsx(\"p\",{children:language==='hindi'?'पृष्ठ को रीफ्रेश करने से सभी वर्तमान प्रविष्टियां हट जाएंगी। क्या आप जारी रखना चाहते हैं?':'Refreshing the page will remove all current entries. Do you want to continue?'}),/*#__PURE__*/_jsxs(\"div\",{className:\"button-container\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:handleRefreshCancel,className:\"cancel-button\",children:language==='hindi'?'रद्द करें':'Cancel'}),/*#__PURE__*/_jsx(\"button\",{onClick:handleRefreshConfirm,className:\"confirm-button\",children:language==='hindi'?'रीफ्रेश करें':'Refresh'})]})]})})]})]});}export default FileUploadForm;","map":{"version":3,"names":["React","useState","useRef","useEffect","useLocation","useNavigate","tasks","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","FileUploadForm","isSubmitting","setIsSubmitting","state","navigate","showModal","setShowModal","selectedTab","setSelectedTab","language","setLanguage","isRecording","setIsRecording","mediaURL","setMediaURL","showTick","setShowTick","mediaRecorderRef","mediaChunksRef","showImageModal","setShowImageModal","showInitialPopup","setShowInitialPopup","countdown","setCountdown","completedTasks","setCompletedTasks","Set","currentQuestionIndex","setCurrentQuestionIndex","showInitialInstructions","setShowInitialInstructions","testCompleted","setTestCompleted","audioBlob","setAudioBlob","videoBlob","setVideoBlob","showRefreshWarning","setShowRefreshWarning","allSelectedAnswers","setAllSelectedAnswers","savedData","sessionStorage","getItem","JSON","parse","patientId","name","age","setItem","stringify","clearDataOnRefresh","clear","window","addEventListener","removeEventListener","blockRefresh","e","preventDefault","stopPropagation","returnValue","blockKeyboardRefresh","metaKey","key","ctrlKey","blockContextMenu","handleRefreshConfirm","location","reload","handleRefreshCancel","TaskCompletion","_ref","audioRef","current","play","calculateScore","totalScore","console","log","Object","keys","length","entries","forEach","_ref2","questionIndex","selections","score","maxScore","handleExit","href","className","children","ref","src","onClick","style","marginTop","padding","backgroundColor","color","border","borderRadius","cursor","fontSize","transition","onMouseOver","target","onMouseOut","handleTabClick","id","has","currentTaskIndex","stop","stream","getTracks","track","handleMediaRecord","mediaType","video","audio","navigator","mediaDevices","getUserMedia","then","mediaRecorder","MediaRecorder","start","countdownInterval","setInterval","prev","clearInterval","event","data","size","push","mediaBlob","Blob","type","url","URL","createObjectURL","catch","err","error","alert","handleReRecord","values","handleSubmit","formData","FormData","append","scoreToSend","calculatedScore","toString","pair","currentBlob","response","fetch","method","body","ok","errorData","json","Error","result","setTimeout","nextTab","message","InstructionModal","_ref3","onClose","InitialInstructions","_ref4","onAccept","onDeny","setIsPatient","marginLeft","MultipleChoiceTask","_ref5","task","handleNext","questions","handlePrevious","handleAnswerSelect","choiceIndex","prevSelected","updatedAnswers","currentAnswers","index","indexOf","filter","idx","totalSelectedCount","reduce","total","currentSelections","textAlign","marginBottom","question","process","env","PUBLIC_URL","alt","maxWidth","height","onError","display","flexDirection","alignItems","choices","map","choice","margin","width","checked","includes","onChange","marginRight","justifyContent","minHeight","disabled","flexWrap","q","finalScore","TaskContent","_ref6","image","maxHeight","objectFit","lineHeight","paragraph","InitialPopup","_ref7","position","top","left","zIndex","right","boxShadow","fontFamily","opacity","undefined","title","onSubmit","gap","controls"],"sources":["/home/soham/aiims/my-app/src/FileUploadForm.js"],"sourcesContent":["  import React, { useState, useRef, useEffect} from 'react';\n  import { useLocation, useNavigate } from 'react-router-dom'; // Add useNavigate here\n  import tasks from './data/tasks';\n  import './App.css';\n\n  function FileUploadForm() {\n    const [isSubmitting, setIsSubmitting] = useState(false);\n    const { state } = useLocation();\n    const navigate = useNavigate();\n    const [showModal, setShowModal] = useState(true);\n    const [selectedTab, setSelectedTab] = useState(0);\n    const [language, setLanguage] = useState('english');\n    const [isRecording, setIsRecording] = useState(false);\n    const [mediaURL, setMediaURL] = useState(\"\");\n    const [showTick, setShowTick] = useState(false);\n    const mediaRecorderRef = useRef(null);\n    const mediaChunksRef = useRef([]);\n    const [showImageModal, setShowImageModal] = useState(false);\n    const [showInitialPopup, setShowInitialPopup] = useState(true);\n    const [countdown, setCountdown] = useState(60);\n    const [completedTasks, setCompletedTasks] = useState(new Set());\n    const [currentQuestionIndex, setCurrentQuestionIndex] = useState(0);\n    const [showInitialInstructions, setShowInitialInstructions] = useState(false);\n    const [testCompleted, setTestCompleted] = useState(false);\n    const [audioBlob, setAudioBlob] = useState(null);\n    const [videoBlob, setVideoBlob] = useState(null);\n    const [showRefreshWarning, setShowRefreshWarning] = useState(false);\n    const [allSelectedAnswers, setAllSelectedAnswers] = useState(() => {\n      const savedData = sessionStorage.getItem(\"allSelectedAnswers\");\n      return savedData ? JSON.parse(savedData) : {};\n    });\n\n\n\n  useEffect(() => {\n    if (!state?.patientId || !state?.name || !state?.age) {\n      navigate('/');\n    }\n  }, [state, navigate]);\n\n  useEffect(() => {\n      sessionStorage.setItem(\"allSelectedAnswers\", JSON.stringify(allSelectedAnswers));\n  }, [allSelectedAnswers]);\n\n  useEffect(() => {\n    const clearDataOnRefresh = () => {\n        sessionStorage.clear();\n    };\n\n    window.addEventListener(\"beforeunload\", clearDataOnRefresh);\n\n    return () => {\n        window.removeEventListener(\"beforeunload\", clearDataOnRefresh);\n    };\n  }, []);\n\n  useEffect(() => {\n    const blockRefresh = (e) => {\n      if (!showInitialPopup) { // If test has started\n        e.preventDefault();\n        e.stopPropagation();\n        \n        // For older browsers\n        if (e.preventDefault) {\n          e.preventDefault();\n        }\n        e.returnValue = '';\n        // Can also show a message if needed\n        return \"Test is in progress. Refresh is disabled.\";\n      }\n    };\n\n    const blockKeyboardRefresh = (e) => {\n      if (!showInitialPopup) { // If test has started\n        if (\n          (e.metaKey && e.key === 'r') || // Cmd + R (macOS)\n          (e.ctrlKey && e.key === 'r') || // Ctrl + R (Windows/Linux)\n          e.key === 'F5'                  // F5 (all platforms)\n        ) {\n          e.preventDefault();\n          e.stopPropagation();\n          return false;\n        }\n      }\n    };\n\n    // Block context menu to prevent refresh\n    const blockContextMenu = (e) => {\n      if (!showInitialPopup) {\n        e.preventDefault();\n      }\n    };\n\n    // Add all event listeners\n    window.addEventListener('beforeunload', blockRefresh);\n    window.addEventListener('keydown', blockKeyboardRefresh);\n    window.addEventListener('contextmenu', blockContextMenu);\n\n    // Cleanup\n    return () => {\n      window.removeEventListener('beforeunload', blockRefresh);\n      window.removeEventListener('keydown', blockKeyboardRefresh);\n      window.removeEventListener('contextmenu', blockContextMenu);\n    };\n  }, [showInitialPopup]);\n\n    const handleRefreshConfirm = () => {\n      setShowRefreshWarning(false);\n      window.location.reload(); // Perform manual refresh\n    };\n    \n    const handleRefreshCancel = () => {\n      setShowRefreshWarning(false);\n    };\n    \n\n    const TaskCompletion = ({ language }) => {\n      const audioRef = useRef(null);\n    \n      useEffect(() => {\n        if (audioRef.current) {\n          audioRef.current.play();\n        }\n      }, []);\n    \n      const calculateScore = () => {\n        let totalScore = 0;\n        console.log('Calculating score. allSelectedAnswers:', allSelectedAnswers);\n        \n        if (Object.keys(allSelectedAnswers).length === 0) {\n          console.log('No answers selected, returning 0');\n          return 0;\n        }\n      \n        Object.entries(allSelectedAnswers).forEach(([questionIndex, selections]) => {\n          if (selections && selections.length > 0) {\n            console.log(`Question ${questionIndex}: adding ${selections.length} points`);\n            totalScore += selections.length;\n          }\n        });\n        \n        console.log('Final calculated score:', totalScore);\n        return totalScore;\n      };\n    \n      const score = calculateScore();\n      const maxScore = 30;\n      \n      const handleExit = () => {\n        sessionStorage.clear()\n        window.location.href = '/';\n      };\n    \n      return (\n        <div className=\"flex flex-col items-center justify-center min-h-screen p-8 bg-white max-w-2xl mx-auto\">\n          <audio\n            ref={audioRef}\n            src={language === 'english' ? '/audio/q16_en.mp3' : '/audio/q16_hi.mp3'}\n          />\n          <div className=\"text-center w-full\">\n            <h2 className=\"text-3xl font-bold mb-8 text-gray-800\">\n              {language === 'hindi' ? 'धन्यवाद!' : 'Thank You!'}\n            </h2>\n            <div className=\"bg-blue-50 p-6 rounded-lg shadow-sm mb-8\">\n              <h3 className=\"text-xl font-semibold mb-2\">\n                {language === 'hindi' ? 'आपका MMSE स्कोर' : 'Your MMSE Score'}\n              </h3>\n              <div className=\"text-4xl font-bold text-blue-600\">\n                {score} / {maxScore}\n              </div>\n            </div>\n            <div className=\"space-y-4\">\n              <p className=\"text-lg\">\n                {language === 'hindi' \n                  ? 'आपका परीक्षण पूरा हो गया है। परिणाम आपके स्वास्थ्य देखभाल प्रदाता द्वारा साझा किए जाएंगे।'\n                  : 'Your test has been completed. The results will be shared by your healthcare provider.'}\n              </p>\n              <p className=\"text-base text-gray-600\">\n                {language === 'hindi'\n                  ? 'कृपया अपने स्वास्थ्य देखभाल प्रदाता से संपर्क करें।'\n                  : 'Please contact your healthcare provider for follow-up.'}\n              </p>\n              \n              <button\n                onClick={handleExit}\n                style={{\n                  marginTop: '2rem',\n                  padding: '10px 20px',\n                  backgroundColor: '#007bff',\n                  color: 'white',\n                  border: 'none',\n                  borderRadius: '4px',\n                  cursor: 'pointer',\n                  fontSize: '1rem',\n                  transition: 'background-color 0.2s'\n                }}\n                onMouseOver={(e) => e.target.style.backgroundColor = '#0056b3'}\n                onMouseOut={(e) => e.target.style.backgroundColor = '#007bff'}\n              >\n                {language === 'hindi' ? 'बाहर निकलें' : 'Exit'}\n              </button>\n            </div>\n          </div>\n        </div>\n      );\n    };\n\n\n    const handleTabClick = (id) => {\n      // Prevent navigation to completed tasks\n      if (completedTasks.has(id)) {\n        return;\n      }\n\n      // Prevent going back to previous tasks\n      const currentTaskIndex = selectedTab;\n      if (id < currentTaskIndex) {\n        return;\n      }\n\n      setCountdown(60);\n      setMediaURL(\"\");\n      mediaChunksRef.current = [];\n    \n      if (mediaRecorderRef.current && mediaRecorderRef.current.state === 'recording') {\n        mediaRecorderRef.current.stop();\n        mediaRecorderRef.current.stream.getTracks().forEach(track => track.stop());\n      }\n    \n      setSelectedTab(id);\n      setShowModal(id !== 2);\n    \n      if (id === 2) {\n        setShowInitialInstructions(true);\n      } else {\n        setShowInitialInstructions(false);\n      }\n    };   \n    \n\n\n    // const toggleLanguage = (e) => {\n    //   e.preventDefault();\n    //   setLanguage((prev) => (prev === 'hindi' ? 'english' : 'hindi'));\n    // };\n\n  const handleMediaRecord = () => {\n    const mediaType = selectedTab === 1 \n      ? { video: true, audio: true }  // Video with audio\n      : { audio: true };              // Audio only\n\n    if (!isRecording) {\n      // Clear previous recording data when starting new recording\n      setMediaURL(\"\");\n      setCountdown(60); // Reset the countdown\n      if (selectedTab === 1) {\n        setVideoBlob(null);\n      } else {\n        setAudioBlob(null);\n      }\n\n      console.log('Starting media recording for:', selectedTab === 1 ? 'video' : 'audio');\n\n      navigator.mediaDevices.getUserMedia(mediaType)\n        .then((stream) => {\n          const mediaRecorder = new MediaRecorder(stream);\n          mediaRecorderRef.current = mediaRecorder;\n          mediaChunksRef.current = [];\n\n          mediaRecorder.start();\n          setIsRecording(true);\n          console.log('MediaRecorder started');\n\n          const countdownInterval = setInterval(() => {\n            setCountdown((prev) => {\n              if (prev <= 1) {\n                clearInterval(countdownInterval);\n                // Automatically stop recording when countdown reaches 0\n                if (mediaRecorder.state === \"recording\") {\n                  console.log('Stopping recording due to countdown');\n                  mediaRecorder.stop();\n                  stream.getTracks().forEach(track => track.stop());\n                  setIsRecording(false);\n                }\n                return 0;\n              }\n              return prev - 1;\n            });\n          }, 1000);\n\n          mediaRecorder.countdownInterval = countdownInterval;\n\n          mediaRecorder.addEventListener('dataavailable', (event) => {\n            if (event.data.size > 0) {\n              mediaChunksRef.current.push(event.data);\n              console.log('Data chunk received:', event.data.size, 'bytes');\n            }\n          });\n\n          mediaRecorder.addEventListener('stop', () => {\n            const mediaBlob = new Blob(mediaChunksRef.current, {\n              type: selectedTab === 1 ? 'video/webm' : 'audio/webm'\n            });\n            console.log('Created media blob:', {\n              type: mediaBlob.type,\n              size: mediaBlob.size\n            });\n\n            const url = URL.createObjectURL(mediaBlob);\n            setMediaURL(url);\n\n            if (selectedTab === 1) {\n              setVideoBlob(mediaBlob);\n              console.log('Video blob set:', mediaBlob);\n            } else {\n              setAudioBlob(mediaBlob);\n              console.log('Audio blob set:', mediaBlob);\n            }\n\n            setIsRecording(false);\n            mediaChunksRef.current = [];\n            clearInterval(mediaRecorder.countdownInterval);\n          });\n        })\n        .catch((err) => {\n          console.error('Error accessing media:', err);\n          setIsRecording(false);\n          alert(`Could not access your ${selectedTab === 1 ? 'camera' : 'microphone'}. Please check your browser settings.`);\n        });\n    } else {\n      if (mediaRecorderRef.current) {\n        mediaRecorderRef.current.stop();\n        mediaRecorderRef.current.stream.getTracks().forEach(track => track.stop());\n        clearInterval(mediaRecorderRef.current.countdownInterval);\n        setCountdown(0);\n        console.log('Recording stopped manually');\n      }\n    }\n  }; \n\n    const handleReRecord = () => {\n      // Clear the current recording\n      setMediaURL(\"\");\n      if (selectedTab === 1) {\n        setVideoBlob(null);\n      } else {\n        setAudioBlob(null);\n      }\n      \n      // Clear media chunks\n      mediaChunksRef.current = [];\n      \n      // Stop any existing streams\n      if (mediaRecorderRef.current && mediaRecorderRef.current.stream) {\n        mediaRecorderRef.current.stream.getTracks().forEach(track => track.stop());\n      }\n      \n      // Start new recording\n      handleMediaRecord();\n    };\n    \n\n    // Inside the handleSubmit function in FileUploadForm.js, update it as follows:\n\n    const calculateScore = () => {\n      let totalScore = 0;\n      // Iterate through all questions\n      Object.values(allSelectedAnswers).forEach((selections) => {\n          // Each correct selection adds 1 point\n          if (selections && selections.length > 0) {\n              totalScore += selections.length;\n          }\n      });\n      return totalScore;\n  };\n\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    if (isSubmitting) {\n        console.log('Already submitting, returning');\n        return;\n    }\n    \n    console.log('Starting submission for tab:', selectedTab);\n    setIsSubmitting(true);\n    \n    try {\n        if (!state?.patientId || !state?.name || !state?.age) {\n            alert('Patient information is missing. Please start over.');\n            navigate('/');\n            return;\n        }\n\n        const formData = new FormData();\n        formData.append('name', state.name);\n        formData.append('age', state.age);\n        formData.append('patientId', state.patientId);\n        \n        // Initialize score as 0\n        let scoreToSend = '0';\n        \n        // Only calculate score for MMSE test (tab 2)\n        if (selectedTab === 2) {\n            const calculatedScore = calculateScore();\n            console.log('Tab 2: Calculated score:', calculatedScore);\n            scoreToSend = calculatedScore.toString();\n        } else {\n            console.log(`Tab ${selectedTab}: Using default score: 0`);\n        }\n        \n        console.log('Setting score in formData:', scoreToSend);\n        formData.append('score', scoreToSend);\n\n        // Log all form data being sent\n        console.log('Form data contents:');\n        for (let pair of formData.entries()) {\n            console.log(`${pair[0]}: ${pair[1]}`);\n        }\n\n        const currentBlob = selectedTab === 1 ? videoBlob : audioBlob;\n        if (!currentBlob) {\n            alert(`Please record ${selectedTab === 1 ? 'video' : 'audio'} before submitting.`);\n            setIsSubmitting(false);\n            return;\n        }\n\n        if (selectedTab === 1) {\n            formData.append('video', currentBlob, 'video.webm');\n        } else if (selectedTab === 0) {\n            formData.append('audio', currentBlob, 'audio.webm');\n        }\n\n        console.log('Sending request to server...');\n        const response = await fetch('http://localhost:5001/save', {\n            method: 'POST',\n            body: formData,\n        });\n\n        if (!response.ok) {\n            const errorData = await response.json();\n            throw new Error(errorData.error || 'Upload failed');\n        }\n\n        const result = await response.json();\n        console.log('Server response:', result);\n\n        setShowTick(true);\n        setTimeout(() => {\n            setShowTick(false);\n            setCompletedTasks((prev) => new Set([...prev, selectedTab]));\n            const nextTab = selectedTab + 1;\n            if (nextTab < tasks.length) {\n                handleTabClick(nextTab);\n            }\n        }, 1000);\n\n        setMediaURL('');\n        if (selectedTab === 1) {\n            setVideoBlob(null);\n        } else {\n            setAudioBlob(null);\n        }\n    } catch (error) {\n        console.error('Submission error:', error);\n        alert(error.message || 'Error uploading file. Please try again.');\n    } finally {\n        setIsSubmitting(false);\n    }\n};\n\nconst InstructionModal = ({ onClose }) => {\n  const audioRef = useRef(null);\n\n  useEffect(() => {\n    if (audioRef.current) {\n      audioRef.current.play();\n    }\n  }, []); // Removed language from dependency array\n\n  return (\n    <div className=\"custom-modal-overlay\">\n      <div className=\"custom-modal-content\">\n        <audio\n          ref={audioRef}\n          src={selectedTab === 0 ? \n            (language === 'english' ? '/audio/q2_en.mp3' : '/audio/q2_hi.mp3') :\n            (language === 'english' ? '/audio/q3_en.mp3' : '/audio/q3_hi.mp3')\n          }\n        />\n        <h2>{language === 'hindi' ? 'निर्देश' : 'Instructions'}</h2>\n        <p style={{ marginTop: '10px', fontSize: '1.2em', color: '#555' }}>\n          {selectedTab === 0 ? (\n            language === 'hindi' ? (\n              <>\n                <p>कृपया \"आवाज़ रिकॉर्ड करें\" पर क्लिक करें और जोर से पढ़ें। आपके पास 1 मिनट है। रिकॉर्डिंग स्वचालित रूप से रुक जाएगी। \"जमा करें\" पर क्लिक करें।</p>\n              </>\n            ) : (\n              <>\n                <p>Please click \"Record Voice\" to start reading aloud. You have 1 minute. Recording will stop automatically. Click \"Submit\" to save.</p>\n              </>\n            )\n          ) : (\n            language === 'hindi' ? (\n              <>\n                <p>कृपया \"वीडियो रिकॉर्ड करें\" पर क्लिक करें और चित्र का वर्णन करें। आपके पास 1 मिनट है। रिकॉर्डिंग स्वचालित रूप से रुक जाएगी। \"जमा करें\" पर क्लिक करें। ज़ूम इन के लिए, कृपया चित्र पर क्लिक करें।</p>\n              </>\n            ) : (\n              <>\n                <p>Please click \"Record Video\" and describe the picture. You have 1 minute. Recording will stop automatically. Click \"Submit\" to save. To zoom in, please click on the picture.</p>\n              </>\n            )\n          )}\n        </p>\n        <button className=\"custom-ok-button\" onClick={onClose}>OK</button>\n      </div>\n    </div>\n  );\n};\n\nconst InitialInstructions = ({ onAccept, onDeny, setIsPatient, language }) => {\n  const audioRef = useRef(null);\n\n  useEffect(() => {\n    if (audioRef.current) {\n      audioRef.current.play();\n    }\n  }, []);\n\n  return (\n    <div className=\"initial-instructions-overlay\">\n      <div className=\"initial-instructions-content\">\n        <audio\n          ref={audioRef}\n          src={language === 'english' ? '/audio/q4_en.mp3' : '/audio/q4_hi.mp3'}\n        />\n        <h2>{language === 'hindi' ? 'ऑनलाइन MMSE परीक्षण में आपका स्वागत है' : 'Welcome to the Online MMSE Test'}</h2>\n        \n        <p>\n          {language === 'hindi' ? (\n            <>\n              <strong>ऑनलाइन MMSE टेस्ट: तैयारी और निर्देश</strong><br/>\n              <br/>\n              स्वागत है! टेस्ट शुरू करने से पहले कृपया निम्नलिखित सुनिश्चित करें:\n              <ul>\n                <li>एक देखभालकर्ता (Caregiver) की उपस्थिति आवश्यक है, जो टेस्ट ले सके।</li>\n                <li>एक खाली कागज</li>\n                <li>एक पेन या पेंसिल</li>\n                <li>आवश्यक सहायक उपकरण (जैसे, श्रवण यंत्र, चश्मा, घड़ी)</li>\n              </ul>\n              <br/>\n              <strong>देखभालकर्ता के लिए निर्देश:</strong><br/>\n              <ul>\n                <li>व्यक्ति को बैठाएँ: व्यक्ति को अपने सामने ऐसी जगह पर बैठाएँ जहाँ वे आपको स्पष्ट रूप से देख और सुन सकें।</li>\n                <li>प्रश्न पढ़ें: प्रत्येक प्रश्न को व्यक्ति के लिए ज़ोर से पढ़ें।</li>\n                <li>उत्तर चिह्नित करें: यदि व्यक्ति सही उत्तर देता है तो चेकबॉक्स पर निशान लगाएँ।</li>\n                <li>अगले पर जाएं: हर प्रश्न के बाद \"अगला\" पर क्लिक करें।</li>\n              </ul>\n              <br/>\n              क्या आप शुरू करने के लिए तैयार हैं?\n            </>\n          ) : (\n            <>\n              <strong>Online MMSE Test: Preparation & Instructions</strong><br/>\n              <br/>\n              Welcome! Before starting the test, please ensure the following:\n              <ul>\n                <li>A caregiver is present to administer the test.</li>\n                <li>A blank paper</li>\n                <li>A pen or pencil</li>\n                <li>Any necessary aids (e.g., hearing aids, glasses, clock)</li>\n              </ul>\n              <br/>\n              <strong>Instructions for the Caregiver:</strong><br/>\n              <ul>\n                <li>Seat the Patient: Position the patient across from you, where they can see and hear you clearly.</li>\n                <li>Read Aloud: Read each question out loud to the patient.</li>\n                <li>Mark Responses: Check the box if the patient answers correctly.</li>\n                <li>Progress: Click \"Next\" after each question.</li>\n              </ul>\n              <br/>\n              Are you ready to begin?\n            </>\n          )}\n        </p>\n\n        <p>{language === 'hindi' ? 'यदि आप \"स्वीकार करें\" पर क्लिक करते हैं, तो आप परीक्षण में भाग लेने के लिए सहमत हैं।' : 'By clicking \"Accept,\" you agree to participate in the test.'}</p>\n        <div style={{ marginTop: '20px' }}>\n          <button className=\"accept-button\" onClick={onAccept}>\n            {language === 'hindi' ? 'स्वीकार करें' : 'Accept'}\n          </button>\n          <button className=\"deny-button\" onClick={onDeny} style={{ marginLeft: '10px' }}>\n            {language === 'hindi' ? 'अस्वीकार करें' : 'Deny'}\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n};\n\n    const MultipleChoiceTask = ({\n      task,\n      language,\n      setTestCompleted,\n      currentQuestionIndex,\n      setCurrentQuestionIndex,\n      allSelectedAnswers,\n      setAllSelectedAnswers,\n    }) => {\n      const { state } = useLocation();\n      const handleNext = () => {\n        if (currentQuestionIndex < task.questions.length - 1) {\n          setCurrentQuestionIndex(currentQuestionIndex + 1);\n        }\n      };\n    \n      const handlePrevious = () => {\n        if (currentQuestionIndex > 0) {\n          setCurrentQuestionIndex(currentQuestionIndex - 1);\n        }\n      };\n    \n      const handleAnswerSelect = (choiceIndex) => {\n        setAllSelectedAnswers((prevSelected) => {\n          const updatedAnswers = { ...prevSelected };\n          \n          // Initialize array for current question if it doesn't exist\n          if (!updatedAnswers[currentQuestionIndex]) {\n            updatedAnswers[currentQuestionIndex] = [];\n          }\n          \n          const currentAnswers = updatedAnswers[currentQuestionIndex];\n          \n          // Toggle selection\n          const index = currentAnswers.indexOf(choiceIndex);\n          if (index === -1) {\n            // Add the choice if not already selected\n            updatedAnswers[currentQuestionIndex] = [...currentAnswers, choiceIndex];\n          } else {\n            // Remove the choice if already selected\n            updatedAnswers[currentQuestionIndex] = currentAnswers.filter(\n              (idx) => idx !== choiceIndex\n            );\n          }\n          \n          return updatedAnswers;\n        });\n      };\n    \n      const totalSelectedCount = Object.values(allSelectedAnswers).reduce(\n        (total, selections) => total + selections.length,\n        0\n      );\n    \n      const currentSelections = allSelectedAnswers[currentQuestionIndex] || [];\n      \n      return (\n        <div className=\"multiple-choice-task\">\n          <h3 style={{ textAlign: 'center', marginBottom: '5px' }}>\n            {task.questions[currentQuestionIndex].question[language]}\n          </h3>\n\n          {currentQuestionIndex === 10 ? (\n            <div style={{ textAlign: 'center', marginTop: '10px' }}>\n              <img \n                src={process.env.PUBLIC_URL + '/pentagon.png'} \n                alt=\"Shape for copying\" \n                style={{ maxWidth: '45%', height: 'auto' }}\n                onError={(e) => {\n                  console.error(\"Image failed to load\");\n                  console.log(\"Attempted path:\", e.target.src);\n                }}\n              />\n              <div style={{ display: 'flex', flexDirection: 'column', alignItems: 'center', marginTop: '10px' }}>\n                {task.questions[currentQuestionIndex].choices.map((choice, index) => (\n                  <label\n                    key={index}\n                    style={{\n                      display: 'flex',\n                      alignItems: 'center',\n                      textAlign: 'center',\n                      margin: '5px 0',\n                      width: '200px',\n                    }}\n                  >\n                    <input\n                      type=\"checkbox\"\n                      checked={currentSelections.includes(index)}\n                      onChange={() => handleAnswerSelect(index)}\n                      style={{ marginRight: '10px' }}\n                    />\n                    {choice[language]}\n                  </label>\n                ))}\n              </div>\n            </div>\n          ) : (\n            // Default rendering for other questions\n            <div style={{\n              display: 'flex',\n              flexDirection: 'column',\n              alignItems: 'center',\n              justifyContent: 'center',\n              minHeight: '30vh',\n              marginTop: '10px'\n            }}>\n              {task.questions[currentQuestionIndex].choices.map((choice, index) => (\n                <label\n                  key={index}\n                  style={{\n                    display: 'flex',\n                    alignItems: 'center',\n                    textAlign: 'center',\n                    margin: '5px 0',\n                    width: '200px',\n                  }}\n                >\n                  <input\n                    type=\"checkbox\"\n                    checked={currentSelections.includes(index)}\n                    onChange={() => handleAnswerSelect(index)}\n                    style={{ marginRight: '10px' }}\n                  />\n                  {choice[language]}\n                </label>\n              ))}\n            </div>\n          )}\n\n          {/* Navigation Buttons and Counter */}\n          <div className=\"navigation-container\" style={{\n            display: 'flex',\n            justifyContent: 'space-between',\n            alignItems: 'center',\n            marginTop: '10px'\n          }}>\n            <div className=\"navigation-buttons\">\n              <button onClick={handlePrevious} disabled={currentQuestionIndex === 0} style={{ marginRight: '10px' }}>\n                {language === 'hindi' ? 'पिछला' : 'Previous'}\n              </button>\n              <button onClick={handleNext} disabled={currentQuestionIndex === task.questions.length - 1}>\n                {language === 'hindi' ? 'अगला' : 'Next'}\n              </button>\n            </div>\n            <div className=\"selected-counter\" style={{ marginRight: '20px' }}>\n              {language === 'hindi'\n                ? `चयनित: ${totalSelectedCount}`\n                : `Score: ${totalSelectedCount}`}\n            </div>\n          </div>\n\n          {/* Question Number Navigation */}\n          <div\n            className=\"question-number-navigation\"\n            style={{\n              marginTop: '10px',\n              display: 'flex',\n              justifyContent: 'center',\n              flexWrap: 'wrap',\n            }}\n          >\n            {task.questions.map((q, index) => (\n              <button\n                key={index}\n                onClick={() => {\n                  setCurrentQuestionIndex(index);\n                }}\n                style={{\n                  margin: '5px',\n                  padding: '10px',\n                  backgroundColor: index === currentQuestionIndex ? '#007bff' : '#f0f0f0',\n                  color: index === currentQuestionIndex ? '#fff' : '#000',\n                  border: '1px solid #ccc',\n                  borderRadius: '4px',\n                  cursor: 'pointer',\n                }}\n              >\n                {index + 1}\n              </button>\n            ))}\n          </div>\n{/* Submit Button */}\n<div style={{ marginTop: '20px', textAlign: 'center' }}>\n            <button\n              onClick={async () => {\n                const finalScore = Object.values(allSelectedAnswers).reduce(\n                  (total, selections) => total + (selections ? selections.length : 0),\n                  0\n                );\n                \n                console.log('Final MMSE score:', finalScore);\n                const formData = new FormData();\n                formData.append('name', state.name);\n                formData.append('age', state.age);\n                formData.append('patientId', state.patientId);\n                formData.append('score', finalScore.toString());\n\n                try {\n                  console.log('Sending MMSE score to server:', finalScore);\n                  const response = await fetch('http://localhost:5001/save', {\n                    method: 'POST',\n                    body: formData,\n                  });\n\n                  if (!response.ok) {\n                    throw new Error('Failed to save MMSE score');\n                  }\n\n                  console.log('MMSE score saved successfully');\n                  setTestCompleted(true);\n                } catch (error) {\n                  console.error('Error saving MMSE score:', error);\n                  alert('Failed to save test score. Please try again.');\n                }\n              }}\n              style={{\n                padding: '10px 20px',\n                backgroundColor: '#28a745',\n                color: '#fff',\n                border: 'none',\n                borderRadius: '4px',\n                cursor: 'pointer',\n              }}\n            >\n              {language === 'hindi' ? 'जमा करें' : 'Submit'}\n            </button>\n          </div>\n\n        </div>\n      );\n    };\n\n    const TaskContent = ({\n      task,\n      language,\n      testCompleted,\n      showInitialInstructions,\n      setShowInitialInstructions,\n      setTestCompleted,\n      allSelectedAnswers,\n      setAllSelectedAnswers,\n      setIsPatient,\n      currentQuestionIndex,\n      setCurrentQuestionIndex\n    }) => {\n      if (task.id === 2) {\n        if (testCompleted) {\n          return (\n            <div className=\"w-full flex justify-center items-center\">\n              <TaskCompletion \n                language={language}\n                allSelectedAnswers={allSelectedAnswers} \n              />\n            </div>\n          );\n        }\n        // If initial instructions are to be shown\n        if (showInitialInstructions) {\n          return (\n            <InitialInstructions\n              onAccept={() => setShowInitialInstructions(false)}\n              onDeny={() => {\n                setShowInitialInstructions(false);\n                setTestCompleted(true);\n              }}\n              setIsPatient={setIsPatient}  // Pass it here\n              language={language}\n            />\n          );\n        }\n\n        // Render the MultipleChoiceTask\n        return (\n          <MultipleChoiceTask\n            task={task}\n            language={language}\n            setTestCompleted={setTestCompleted}\n            allSelectedAnswers={allSelectedAnswers}\n            setAllSelectedAnswers={setAllSelectedAnswers}\n            currentQuestionIndex={currentQuestionIndex}\n            setCurrentQuestionIndex={setCurrentQuestionIndex}\n          />\n        );      \n      }\n\n      return (\n        <div className=\"task-content\">\n          {task.image ? (\n            <>\n            {/* Added click to enlarge text */}\n          <div style={{ \n            textAlign: 'left', \n            marginBottom: '5px',\n            fontSize: '14px',\n            color: '#666',\n            cursor: 'pointer'\n          }}>\n            {language === 'hindi' ? 'ज़ूम इन/ज़ूम आउट करने के लिए छवि पर क्लिक करें' : 'Click on the image to zoom in / zoom out'} 🔍\n          </div>\n              <img\n                src={task.image}\n                alt=\"Task\"\n                style={{ cursor: 'pointer', maxWidth: '100%', maxHeight: '100%' }}\n                onClick={() => setShowImageModal(true)}\n              />\n              {showImageModal && (\n                <div className=\"image-modal\">\n                  <img\n                    src={task.image}\n                    alt=\"Popup Task\"\n                    style={{ maxWidth: '90%', maxHeight: '90%', objectFit: 'contain' }}\n                    onClick={() => setShowImageModal(false)}\n                  />\n                </div>\n              )}\n            </>\n          ) : (\n            <p style={{ width: '60%', margin: '0 auto', lineHeight: '1.8', fontSize: '1.1em' }}>\n              {task.paragraph[language]}\n            </p>\n          )}\n        </div>\n      );\n    };\n  \n    const InitialPopup = ({ language, setLanguage, onClose }) => {\n      const audioRef = useRef(null);\n     \n      useEffect(() => {\n        if (audioRef.current) {\n          audioRef.current.play();\n        }\n      }, [language]);\n     \n      return (\n        <div className=\"initial-popup-overlay\" \n          style={{\n            position: 'fixed',\n            top: 0,\n            left: 0,\n            width: '100%',\n            height: '100%',\n            backgroundColor: 'white',\n            zIndex: 1000,\n            display: 'flex',\n            justifyContent: 'center',\n            alignItems: 'center',\n          }}>\n          <audio\n            ref={audioRef}\n            src={language === 'english' ? '/audio/q1_en.mp3' : '/audio/q1_hi.mp3'}\n          />\n          <div className=\"initial-popup-content\"\n            style={{ maxWidth: '600px', width: '90%', textAlign: 'center' }}>\n            <h2>\n              {language === 'english' \n                ? 'Welcome to the Dementia Test!' \n                : 'डिमेंशिया टेस्ट में आपका स्वागत है!'}\n            </h2>\n            <p style={{ marginTop: '10px', fontSize: '1.2em', color: '#555' }}>\n              {language === 'english' ? (\n                <>\n                  This test includes three parts:\n                  <br /><br />\n                  <strong>Paragraph Reading</strong> (1 min)<br />\n                  <strong>Picture Interpretation</strong> (1 min)<br />\n                  <strong>MMSE online test</strong> (~15 min, requires a caregiver if available)\n                  <br /><br />\n                  Please ensure you're in a quiet space with audio and video recording permissions enabled.\n                  <br /><br />\n                  Please Choose the language for the test\n                </>\n              ) : (\n                <>\n                  यह टेस्ट तीन भागों में है:\n                  <br /><br />\n                  <strong>पैराग्राफ पढ़ना</strong> (1 मिनट)<br />\n                  <strong>चित्र व्याख्या</strong> (1 मिनट)<br />\n                  <strong>MMSE ऑनलाइन टेस्ट</strong> (~15 मिनट, केयरगिवर उपलब्ध हो तो)\n                  <br /><br />\n                  कृपया सुनिश्चित करें कि आप शांत स्थान में हैं और ऑडियो-वीडियो रिकॉर्डिंग अनुमति सक्षम है।\n                  <br /><br />\n                  कृपया परीक्षण के लिए भाषा चुनें\n                </>\n              )}\n            </p>\n            <div className=\"language-selection\" style={{ marginTop: '20px' }}>\n              <button\n                onClick={() => setLanguage('english')}\n                className={`language-button ${language === 'english' ? 'active' : ''}`}\n                style={{ marginRight: '10px', padding: '10px 20px' }}>\n                English\n              </button>\n              <button\n                onClick={() => setLanguage('hindi')}\n                className={`language-button ${language === 'hindi' ? 'active' : ''}`}\n                style={{ padding: '10px 20px' }}>\n                हिंदी\n              </button>\n            </div>\n            <button\n              onClick={onClose}\n              className=\"begin-test-button\"\n              style={{ marginTop: '20px', padding: '10px 20px' }}>\n              {language === 'english' ? 'Begin Test' : 'टेस्ट शुरू करें'}\n            </button>\n          </div>\n        </div>\n      );\n     };\n\n  return (\n    <div className=\"app\">\n      {/* Patient ID Display */}\n      {state?.patientId && (\n        <div style={{\n          position: 'fixed',\n          top: '20px',\n          right: '20px',\n          backgroundColor: 'white',\n          padding: '8px 12px',\n          borderRadius: '4px',\n          boxShadow: '0 2px 4px rgba(0, 0, 0, 0.1)',\n          zIndex: 1000,\n          fontFamily: 'monospace',\n          fontSize: '14px',\n          border: '1px solid #ddd'\n        }}>\n          Patient ID: {state.patientId}\n        </div>\n      )}\n\n      {/* Initial Test Setup Modal */}\n      {showInitialPopup ? (\n        <InitialPopup\n          language={language}\n          setLanguage={setLanguage}\n          onClose={() => setShowInitialPopup(false)}\n        />\n      ) : (\n        <>\n          {/* Instructions Modal */}\n          {showModal && <InstructionModal onClose={() => setShowModal(false)} />}\n\n          {/* Main Content */}\n          <div className=\"gradient-bg\" />\n          <div className=\"container\">\n            {/* Navigation Tabs */}\n            <div className=\"tabs\">\n              {tasks\n                .filter((task) => !(task.id === 2 && testCompleted))\n                .map((task) => (\n                  <div\n                    key={task.id}\n                    className={`tab ${selectedTab === task.id ? 'active' : ''} \n                              ${completedTasks.has(task.id) ? 'completed' : ''}\n                              ${task.id < selectedTab ? 'disabled' : ''}`}\n                    onClick={() => handleTabClick(task.id)}\n                    style={{\n                      cursor: completedTasks.has(task.id) || task.id < selectedTab ? 'not-allowed' : 'pointer',\n                      opacity: completedTasks.has(task.id) || task.id < selectedTab ? 0.6 : 1,\n                      backgroundColor: completedTasks.has(task.id) ? '#e0e0e0' : undefined\n                    }}\n                  >\n                    {task.title[language]}\n                    {completedTasks.has(task.id) && (\n                      <span style={{ marginLeft: '5px', color: 'green' }}>✓</span>\n                    )}\n                  </div>\n                ))}\n            </div>\n\n            {/* Task Content Area */}\n            <div className=\"content\">\n              <TaskContent\n                task={tasks[selectedTab]}\n                language={language}\n                testCompleted={testCompleted}\n                showInitialInstructions={showInitialInstructions}\n                setShowInitialInstructions={setShowInitialInstructions}\n                setTestCompleted={setTestCompleted}\n                allSelectedAnswers={allSelectedAnswers}\n                setAllSelectedAnswers={setAllSelectedAnswers}\n                currentQuestionIndex={currentQuestionIndex}\n                setCurrentQuestionIndex={setCurrentQuestionIndex}\n              />\n\n              {/* Media Recording Form */}\n              {selectedTab !== 2 && (\n                <form\n                  onSubmit={handleSubmit}\n                  className=\"media-form\"\n                  style={{\n                    display: 'flex',\n                    flexDirection: 'column',\n                    alignItems: 'center',\n                    gap: '15px',\n                    marginTop: '20px'\n                  }}\n                >\n                  <div className=\"media-controls\">\n                  {mediaURL ? (\n                      <div className=\"media-playback\">\n                        {selectedTab === 1 ? (\n                          <video \n                            src={mediaURL} \n                            controls\n                            style={{\n                              maxWidth: '350px',  // Set maximum width\n                              width: '100%',      // Responsive width\n                              height: 'auto',     // Maintain aspect ratio\n                              marginBottom: '10px' // Add some spacing\n                            }} \n                          />\n                        ) : (\n                          <audio src={mediaURL} controls />\n                        )}\n                        <button \n                          type=\"button\" \n                          onClick={handleReRecord} \n                          className=\"custom-button\"\n                        >\n                          {language === 'hindi' ? 'पुनः रिकॉर्ड करें' : 'Re-record'}\n                        </button>\n                      </div>\n                    ) : (\n                      <div className=\"recording-controls\">\n                        <div style={{ textAlign: 'center', marginTop: '10px' }}>\n                          {isRecording && <p>Time remaining: {countdown}s</p>}\n                        </div>\n                        <button\n                          type=\"button\"\n                          onClick={handleMediaRecord}\n                          className=\"custom-button\"\n                          style={{\n                            marginBottom: '10px',\n                            padding: '8px 12px',\n                            backgroundColor: '#007bff',\n                            color: 'white',\n                            border: 'none',\n                            borderRadius: '4px',\n                            cursor: 'pointer'\n                          }}\n                        >\n                          {isRecording\n                            ? (language === 'hindi' ? 'रिकॉर्डिंग रोकें' : 'Stop Recording')\n                            : language === 'hindi'\n                            ? selectedTab === 1\n                              ? 'वीडियो रिकॉर्ड करें'\n                              : 'आवाज़ रिकॉर्ड करें'\n                            : selectedTab === 1\n                            ? 'Record Video'\n                            : 'Record Voice'}\n                        </button>\n                      </div>\n                    )}\n                  </div>\n\n                  <button \n                    type=\"submit\" \n                    disabled={!mediaURL || isSubmitting} \n                    className=\"custom-button\"\n                    style={{\n                      opacity: (!mediaURL || isSubmitting) ? 0.6 : 1\n                    }}\n                  >\n                    {language === 'hindi' ? 'जमा करें' : 'Submit'}\n                  </button>\n\n                  {showTick && <span className=\"tick\">✔</span>}\n                </form>\n              )}\n            </div>\n          </div>\n\n          {/* Refresh Warning Modal */}\n          {showRefreshWarning && (\n            <div className=\"modal-overlay\">\n              <div className=\"modal-content\">\n                <h2>{language === 'hindi' ? 'पृष्ठ रीफ्रेश की पुष्टि करें' : 'Confirm Page Refresh'}</h2>\n                <p>\n                  {language === 'hindi' \n                    ? 'पृष्ठ को रीफ्रेश करने से सभी वर्तमान प्रविष्टियां हट जाएंगी। क्या आप जारी रखना चाहते हैं?'\n                    : 'Refreshing the page will remove all current entries. Do you want to continue?'}\n                </p>\n                <div className=\"button-container\">\n                  <button onClick={handleRefreshCancel} className=\"cancel-button\">\n                    {language === 'hindi' ? 'रद्द करें' : 'Cancel'}\n                  </button>\n                  <button onClick={handleRefreshConfirm} className=\"confirm-button\">\n                    {language === 'hindi' ? 'रीफ्रेश करें' : 'Refresh'}\n                  </button>\n                </div>\n              </div>\n            </div>\n          )}\n        </>\n      )}\n    </div>\n  );\n  }\n  export default FileUploadForm;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}